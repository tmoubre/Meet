<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>OAuth2 Callback</title>
  </head>
  <body>
    <script>
      const params = new URLSearchParams(window.location.search);
      const code = params.get("code");

      if (!code) {
        document.body.innerText = "Error: No code found in URL.";
      } else {
        fetch("https://oo8j9y6bg6.execute-api.us-east-2.amazonaws.com/dev/api/exchange-code", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ code }),
        })
          .then((res) => res.json())
          .then((data) => {
            document.body.innerText = "Access token: " + JSON.stringify(data, null, 2);
          })
          .catch((err) => {
            document.body.innerText = "Error: " + err.message;
          });
      }
    </script>
  </body>
</html>
